<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>tKOI • tkoi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="tKOI">
<meta name="description" content="A system for enriching biological concepts and integrating transcriptomic data with a human-specific heterogeneous biological knowledge graph from transcriptomics data. It enables advanced analyses, including pathway enrichment, network-based gene ranking, and functional annotation. Key features include personalized PageRank computation, visualization of network enrichment, and seamless integration with biological ontologies. The package is designed for users in genomics and computational biology to gain insights from large-scale transcriptomic data.">
<meta property="og:description" content="A system for enriching biological concepts and integrating transcriptomic data with a human-specific heterogeneous biological knowledge graph from transcriptomics data. It enables advanced analyses, including pathway enrichment, network-based gene ranking, and functional annotation. Key features include personalized PageRank computation, visualization of network enrichment, and seamless integration with biological ontologies. The package is designed for users in genomics and computational biology to gain insights from large-scale transcriptomic data.">
<meta property="og:image" content="/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">tkoi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="articles/index.html">Vignettes</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="tkoi-">tKOI <a class="anchor" aria-label="anchor" href="#tkoi-"></a>
</h1>
</div>
<p><strong>Transcriptomic Knowledge-Graph Omics Integration for Human Pathway Analysis</strong></p>
<p>The <code>tkoi</code> package provides an integrative framework that combines transcriptomic data with a human-specific biological knowledge graph. This enables network-aware enrichment, functional interpretation, and gene prioritization via personalized PageRank and ontology-aware annotation.</p>
<div class="section level2">
<h2 id="web-application">Web Application<a class="anchor" aria-label="anchor" href="#web-application"></a>
</h2>
<p>For non-power users, please use the web application of <strong><a href="https://comphealth.ucsf.edu/app/tkoi" class="external-link">tKOI</a></strong> at <code>tkoi.org</code>.</p>
</div>
<div class="section level2">
<h2 id="contextualization-agent">Contextualization Agent<a class="anchor" aria-label="anchor" href="#contextualization-agent"></a>
</h2>
<p>For subsequent analysis upon getting network enrichment statistics, please use <strong><a href="https://github.com/BaranziniLab/tKOIAgent" class="external-link">tKOIAgent</a></strong> for contextualization and network treversal.</p>
</div>
<div class="section level2">
<h2 id="documentations">Documentations<a class="anchor" aria-label="anchor" href="#documentations"></a>
</h2>
<p>Please refer to <strong><a href="https://broccolito.github.io/software/tkoi/index.html" class="external-link">Documentation</a></strong> for detailed documentation of this R package.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install the development version from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install devtools if necessary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Install tkoi</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"Broccolito/tkoi"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="core-features">Core Features<a class="anchor" aria-label="anchor" href="#core-features"></a>
</h2>
<ul>
<li>Personalized PageRank propagation using transcriptomic weights</li>
<li>Permutation-based enrichment scoring for network nodes</li>
<li>Functional annotation using Gene Ontology, Disease Ontology, Cell Ontology, Reactome, and more</li>
<li>Modular and extensible S4 object design (<code>tKOIList</code>)</li>
<li>Export and visualization tools for enriched subnetworks</li>
<li>Seamless compatibility with <code>clusterProfiler</code>, <code>enrichplot</code>, and <code>ggplot2</code> ## Getting Started</li>
</ul>
<div class="section level3">
<h3 id="example-workflow">Example Workflow<a class="anchor" aria-label="anchor" href="#example-workflow"></a>
</h3>
<p>This section walks you through a complete example using the <code>tkoi</code> package—from reading expression data, running the core network analysis, to visualizing enrichment results.</p>
</div>
<div class="section level3">
<h3 id="step-1-load-example-gene-expression-data">Step 1: Load Example Gene Expression Data<a class="anchor" aria-label="anchor" href="#step-1-load-example-gene-expression-data"></a>
</h3>
<p>The <code>tkoi</code> package includes a small example CSV file containing simulated gene expression results. We’ll read it using <code>data.table</code> for performance.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">tkoi</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the file path of the example expression data</span></span>
<span><span class="va">file_path</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"example_data.csv"</span>, package <span class="op">=</span> <span class="st">"tkoi"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read the CSV file</span></span>
<span><span class="va">expression_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="va">file_path</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">expression_data</span><span class="op">)</span></span></code></pre></div>
<p>The file includes columns:</p>
<ul>
<li>
<code>gene_name</code>: Ensembl gene identifiers</li>
<li>
<code>logfc</code>: log2 fold-change values</li>
<li>
<code>pvalue</code>: associated p-values for differential expression</li>
</ul>
</div>
<div class="section level3">
<h3 id="step-2-run-tkoi-network-enrichment-analysis">Step 2: Run tKOI Network Enrichment Analysis<a class="anchor" aria-label="anchor" href="#step-2-run-tkoi-network-enrichment-analysis"></a>
</h3>
<p><code>tKOI</code> integrates transcriptomic changes with a biological knowledge graph using a personalized PageRank algorithm. It also performs permutations to assess statistical enrichment.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tkoi_result</span> <span class="op">=</span> <span class="fu"><a href="reference/run_tkoi.html">run_tkoi</a></span><span class="op">(</span></span>
<span>  expression_data <span class="op">=</span> <span class="va">expression_data</span>,</span>
<span>  subnetwork <span class="op">=</span> <span class="fu">tkoi</span><span class="fu">::</span><span class="va"><a href="reference/tkoi_net.html">tkoi_net</a></span>,    <span class="co"># Predefined igraph network included with the package</span></span>
<span>  pvalue_threshold <span class="op">=</span> <span class="fl">0.05</span>,        <span class="co"># p-value filter for differential expression</span></span>
<span>  logfc_threshold <span class="op">=</span> <span class="fl">0.25</span>,         <span class="co"># Minimum log fold change</span></span>
<span>  indirect_link_threshold <span class="op">=</span> <span class="fl">3</span>,    <span class="co"># Required indirect connectivity for downstream inclusion</span></span>
<span>  topology_similarity <span class="op">=</span> <span class="fl">0.9</span>,      <span class="co"># Similarity for selecting matched genes in permutations</span></span>
<span>  n_permutation <span class="op">=</span> <span class="fl">100</span>,            <span class="co"># Number of random permutations</span></span>
<span>  damping_factor <span class="op">=</span> <span class="fl">0.85</span>,          <span class="co"># PageRank damping factor</span></span>
<span>  maximum_iteration <span class="op">=</span> <span class="fl">500</span>         <span class="co"># Max iterations for convergence</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The result is an S4 object (<code>tKOIList</code>) that stores PageRank scores, permutation statistics, and network annotations.</p>
</div>
<div class="section level3">
<h3 id="step-3-perform-gene-ontology-go-enrichment">Step 3: Perform Gene Ontology (GO) Enrichment<a class="anchor" aria-label="anchor" href="#step-3-perform-gene-ontology-go-enrichment"></a>
</h3>
<p>You can extend the analysis by integrating GO term enrichment using <code>clusterProfiler</code>. This allows for side-by-side comparisons of ontology-based and graph-based enrichment.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tkoi_result</span> <span class="op">=</span> <span class="fu"><a href="reference/run_gene_enrichment.html">run_gene_enrichment</a></span><span class="op">(</span><span class="va">tkoi_result</span><span class="op">)</span></span></code></pre></div>
<p>This adds a <code>gene_enrichment_comparison</code> slot containing GO enrichment tables and visual summaries.</p>
</div>
<div class="section level3">
<h3 id="step-4-visualize-go-vs-graph-enrichment">Step 4: Visualize GO vs Graph Enrichment<a class="anchor" aria-label="anchor" href="#step-4-visualize-go-vs-graph-enrichment"></a>
</h3>
<p>Two visualizations are automatically generated:</p>
<div class="section level4">
<h4 id="scatter-plot-all-terms">Scatter Plot (All Terms)<a class="anchor" aria-label="anchor" href="#scatter-plot-all-terms"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tkoi_result</span><span class="op">@</span><span class="va">gene_enrichment_comparison</span><span class="op">$</span><span class="va">comparison_scatter1</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="scatter-plot-faceted-by-go-namespace">Scatter Plot (Faceted by GO Namespace)<a class="anchor" aria-label="anchor" href="#scatter-plot-faceted-by-go-namespace"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tkoi_result</span><span class="op">@</span><span class="va">gene_enrichment_comparison</span><span class="op">$</span><span class="va">comparison_scatter2</span></span></code></pre></div>
<p>These plots compare tKOI network enrichment (<code>beta</code>) with gene ontology q-values.</p>
</div>
</div>
<div class="section level3">
<h3 id="step-5-visualize-differential-genes-in-the-network">Step 5: Visualize Differential Genes in the Network<a class="anchor" aria-label="anchor" href="#step-5-visualize-differential-genes-in-the-network"></a>
</h3>
<p>The <code><a href="reference/make_gene_exploration_plot.html">make_gene_exploration_plot()</a></code> function highlights upregulated and downregulated genes in a scatter plot based on both experimental and network evidence.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt1</span> <span class="op">=</span> <span class="fu"><a href="reference/make_gene_exploration_plot.html">make_gene_exploration_plot</a></span><span class="op">(</span></span>
<span>  tkoi_list <span class="op">=</span> <span class="va">tkoi_result</span>,</span>
<span>  sig_color <span class="op">=</span> <span class="st">"#F39B7FB2"</span>,</span>
<span>  non_sig_color <span class="op">=</span> <span class="st">"gray"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">plt1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-6-export-gene-level-prioritization-table">Step 6: Export Gene-Level Prioritization Table<a class="anchor" aria-label="anchor" href="#step-6-export-gene-level-prioritization-table"></a>
</h3>
<p>This returns a data frame containing logFC, p-values, PageRank scores, and FDRs for each gene.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_data</span> <span class="op">=</span> <span class="fu"><a href="reference/export_gene_exploration_data.html">export_gene_exploration_data</a></span><span class="op">(</span><span class="va">tkoi_result</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gene_data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-7-visualize-top-n-enriched-nodes">Step 7: Visualize Top N Enriched Nodes<a class="anchor" aria-label="anchor" href="#step-7-visualize-top-n-enriched-nodes"></a>
</h3>
<p>Use <code><a href="reference/visualize_topn.html">visualize_topn()</a></code> to highlight the most significantly enriched genes, pathways, or biological concepts based on network-level statistics.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt2</span> <span class="op">=</span> <span class="fu"><a href="reference/visualize_topn.html">visualize_topn</a></span><span class="op">(</span></span>
<span>  tkoi_list <span class="op">=</span> <span class="va">tkoi_result</span>,</span>
<span>  category <span class="op">=</span> <span class="st">"Gene"</span>,       <span class="co"># Can also be "Pathway", "BiologicalProcess", etc.</span></span>
<span>  top_n <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  high_color <span class="op">=</span> <span class="st">"#FF5733"</span>,  <span class="co"># Strong enrichment</span></span>
<span>  low_color <span class="op">=</span> <span class="st">"#154360"</span>    <span class="co"># Moderate enrichment</span></span>
<span><span class="op">)</span></span>
<span><span class="va">plt2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-8-optional-save-the-analysis-result">Step 8: (Optional) Save the Analysis Result<a class="anchor" aria-label="anchor" href="#step-8-optional-save-the-analysis-result"></a>
</h3>
<p>Save your full analysis object for future use:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">tkoi_result</span>, file <span class="op">=</span> <span class="st">"tkoi_result.rda"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="s4-object-structure">S4 Object Structure<a class="anchor" aria-label="anchor" href="#s4-object-structure"></a>
</h2>
<p><code>tKOIList</code> is an S4 object returned by <code><a href="reference/run_tkoi.html">run_tkoi()</a></code> with the following slots:</p>
<ul>
<li>
<code>expression_data</code>: Input transcriptomic measurements</li>
<li>
<code>pagerank_data</code>: Personalized PageRank vectors</li>
<li>
<code>network_summary_statistics</code>: Node-level enrichment results</li>
<li>
<code>gene_enrichment_comparison</code>: GO enrichment overlay and plots</li>
</ul>
</div>
<div class="section level2">
<h2 id="annotation-resources">Annotation Resources<a class="anchor" aria-label="anchor" href="#annotation-resources"></a>
</h2>
<p>Built-in annotation tables support functional interpretation of the knowledge graph:</p>
<ul>
<li>
<code>go_annotation</code>, <code>disease_annotation</code>, <code>celltype_annotation</code>, <code>anatomy_annotation</code>
</li>
<li>
<code>compound_annotation</code>, <code>protein_annotation</code>, <code>complex_annotation</code>
</li>
<li>
<code>reaction_annotation</code>, <code>pathway_annotation</code>, <code>pwgroup_annotation</code>, etc.</li>
</ul>
<p>Inspect them like so:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">go_annotation</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">go_annotation</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>MIT + file LICENSE</p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Gu, W., Bellucci, G., Peetoom, B., McDonagh, M., &amp; Baranzini, S. (in preparation). Integrating Large-Scale Knowledge Graphs to Enhance Transcriptomics Analysis.</p>
</div>
<div class="section level2">
<h2 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h2>
<p><strong>Wanjun Gu</strong> <a href="mailto:wanjun.gu@ucsf.edu" class="email">wanjun.gu@ucsf.edu</a> ORCID: <a href="https://orcid.org/0000-0002-7342-7000" class="external-link">0000-0002-7342-7000</a></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Broccolito/tkoi" class="external-link">GitHub</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing tkoi</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Wanjun Gu <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-7342-7000" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Wanjun Gu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>

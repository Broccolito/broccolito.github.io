% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/make_gene_exploration_plot.R
\name{make_gene_exploration_plot}
\alias{make_gene_exploration_plot}
\title{Create Gene Exploration Plot}
\usage{
make_gene_exploration_plot(
  tkoi_list,
  sig_color = "#F39B7FB2",
  non_sig_color = "gray"
)
}
\arguments{
\item{tkoi_list}{An object of class \code{tKOIList}. This object must contain the following slots:
\itemize{
\item \code{expression_data}: A \code{data.frame} containing experimental data with columns \code{gene_name}, \code{logfc}, and \code{pvalue}.
\item \code{network_summary_statistics}: A list with a \code{data.frame} for gene-level statistics, including \code{node_id} and \code{fdr}.
\item \code{pvalue_threshold}: A numeric value specifying the p-value threshold.
\item \code{logfc_threshold}: A numeric value specifying the log fold change threshold.
}}

\item{sig_color}{A character string specifying the color for significant genes in the plot. Default is \code{"#F39B7FB2"}.}

\item{non_sig_color}{A character string specifying the color for non-significant genes in the plot. Default is \code{"gray"}.}
}
\value{
A \code{ggplot} object representing the scatter plot.
}
\description{
This function generates a scatter plot that visualizes the relationship between experimental p-values
and tKOI-adjusted false discovery rates (FDR) for genes in the network. The plot highlights
significantly upregulated and downregulated genes based on user-defined thresholds for log fold change
and p-values.
}
\details{
The function performs the following steps:
\enumerate{
\item Merges the \code{expression_data} from the \code{tKOIList} object with gene metadata using \code{inner_join}.
\item Merges the result with gene-level network data using \code{right_join}.
\item Filters and annotates the data to classify genes as upregulated or downregulated based on the sign of \code{logfc}.
\item Colors genes based on their significance determined by \code{logfc_threshold}.
\item Generates a scatter plot with ggplot2, where:
\itemize{
\item The x-axis represents \code{-log10(pvalue)} (experimental p-value).
\item The y-axis represents \code{-log10(fdr)} (tKOI-adjusted FDR).
\item Points are colored and categorized into upregulated and downregulated facets.
}
}

The plot includes vertical and horizontal dashed lines to indicate the thresholds for p-value and FDR.
}
\examples{
\dontrun{
# Create a dummy tKOIList object
tkoi_list <- new("tKOIList",
                 expression_data = data.frame(
                   gene_name = c("gene1", "gene2", "gene3"),
                   logfc = c(1.2, -0.8, 0.5),
                   pvalue = c(0.01, 0.03, 0.2)
                 ),
                 network_summary_statistics = list(
                   Gene = data.frame(
                     node_id = c(1, 2, 3),
                     fdr = c(0.02, 0.05, 0.1)
                   )
                 ),
                 pvalue_threshold = 0.05,
                 logfc_threshold = 0.5)

# Generate the plot
plt <- make_gene_exploration_plot(tkoi_list)
print(plt)
}
}

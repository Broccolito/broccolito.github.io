% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_gene_enrichment.R
\name{run_gene_enrichment}
\alias{run_gene_enrichment}
\title{Run Gene Enrichment and Compare with TKOI Data}
\usage{
run_gene_enrichment(tkoi_list)
}
\arguments{
\item{tkoi_list}{An object of class \code{tKOIList} that contains the input data for analysis. The object should
include the following slots:
\itemize{
\item \code{expression_data}: A \code{data.frame} with columns including \code{gene_name} and \code{pvalue}.
\item \code{network_summary_statistics}: A \code{list} containing network-level summary data for Biological Process (BP),
Cellular Component (CC), and Molecular Function (MF), each stored as a \code{data.frame}.
\item \code{pvalue_threshold}: A \code{numeric} value specifying the significance threshold for filtering genes.
}}
}
\value{
A \code{tKOIList} object with the \code{gene_enrichment_comparison} slot populated. This slot is a \code{list}
containing:
\itemize{
\item \code{enrichment_result}: A \code{data.frame} with the merged results of the enrichment analysis and TKOI network data.
\item \code{comparison_scatter1}: A \code{ggplot} object visualizing a scatter plot without facets.
\item \code{comparison_scatter2}: A \code{ggplot} object visualizing a scatter plot with facets for each namespace.
}
}
\description{
This function performs gene enrichment analysis using the \code{clusterProfiler} package and integrates the results
with the \code{tKOIList} object, specifically comparing the enrichment results with the TKOI data. It generates
scatter plots visualizing the relationship between TKOI scores and enrichment results.
}
\details{
The function performs the following steps:
\enumerate{
\item Extracts genes with p-values below the threshold specified in the \code{tkoi_list}.
\item Conducts Gene Ontology (GO) enrichment analysis for Biological Process (BP), Cellular Component (CC),
and Molecular Function (MF) using \code{clusterProfiler::enrichGO}.
\item Computes pairwise term similarities using \code{enrichplot::pairwise_termsim}.
\item Merges the enrichment results with TKOI network statistics to create a unified dataset.
\item Generates scatter plots to visualize the relationship between TKOI network enrichment effect size
and gene enrichment q-values.
}
}
\examples{
\dontrun{
# Example usage of the function
library(clusterProfiler)
library(enrichplot)
library(org.Hs.eg.db)
library(ggplot2)
library(dplyr)

# Create a dummy tKOIList object
tkoi_list <- new("tKOIList",
                 expression_data = data.frame(
                   gene_name = c("gene1", "gene2", "gene3"),
                   pvalue = c(0.01, 0.02, 0.2)
                 ),
                 network_summary_statistics = list(
                   BiologicalProcess = data.frame(
                     identifier = c("GO:0008150", "GO:0009987"),
                     node_id = c(1, 2),
                     pagerank = c(0.2, 0.3),
                     beta = c(0.5, 0.4),
                     p_value = c(0.01, 0.02),
                     fdr = c(0.05, 0.1),
                     definition = c("process1", "process2")
                   ),
                   CellularComponent = data.frame(),
                   MolecularFunction = data.frame()
                 ))

# Run the enrichment function
result <- run_gene_enrichment(tkoi_list)
}
}

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>pKOI • pkoi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="pKOI">
<meta name="description" content="A network enrichment tool for integrating proteomic data with a human-specific heterogeneous biological knowledge graph. It supports advanced analyses such as network-guided protein prioritization, pathway enrichment, and multi-ontology annotation. Key features include personalized PageRank-based propagation of differential protein signals, null model simulations based on network topology, and flexible visualization of enriched biological contexts. The package is designed for users in proteomics and systems biology to derive mechanistic insights from large-scale protein quantification data.">
<meta property="og:description" content="A network enrichment tool for integrating proteomic data with a human-specific heterogeneous biological knowledge graph. It supports advanced analyses such as network-guided protein prioritization, pathway enrichment, and multi-ontology annotation. Key features include personalized PageRank-based propagation of differential protein signals, null model simulations based on network topology, and flexible visualization of enriched biological contexts. The package is designed for users in proteomics and systems biology to derive mechanistic insights from large-scale protein quantification data.">
<meta property="og:image" content="/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">pkoi</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="articles/index.html">Vignettes</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="pkoi-">pKOI <a class="anchor" aria-label="anchor" href="#pkoi-"></a>
</h1>
</div>
<p><strong>pKOI</strong> (Proteomic Knowledge-Graph Omics Integration) is an R package that integrates differential proteomics data with a heterogeneous biological knowledge graph. It identifies biologically enriched nodes and pathways using personalized PageRank propagation, topological null simulations, and ontology annotations.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>pKOI</code> from GitHub using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"Broccolito/pkoi"</span><span class="op">)</span></span></code></pre></div>
<p>Make sure you have all system dependencies installed for <code>igraph</code>, <code>dplyr</code>, <code>data.table</code>, <code>purrr</code>, and <code>knitr</code>.</p>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The core function in this package is <code><a href="reference/run_pkoi.html">run_pkoi()</a></code>, which:</p>
<ul>
<li>Filters differential proteomics data for significance.</li>
<li>Maps proteins to a biological network.</li>
<li>Computes personalized PageRank using effect sizes.</li>
<li>Performs permutation testing to simulate network background.</li>
<li>Annotates significantly enriched nodes with ontology information.</li>
</ul>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">pkoi</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run pKOI on example proteomics data</span></span>
<span><span class="va">result</span> <span class="op">=</span> <span class="fu"><a href="reference/run_pkoi.html">run_pkoi</a></span><span class="op">(</span></span>
<span>  proteomics_data <span class="op">=</span> <span class="fu">pkoi</span><span class="fu">::</span><span class="va">example_data1</span>,</span>
<span>  pvalue_threshold <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  logfc_threshold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  topology_by <span class="op">=</span> <span class="st">"degree"</span>,</span>
<span>  topology_similarity <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  n_permutation <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  damping_factor <span class="op">=</span> <span class="fl">0.85</span>,</span>
<span>  maximum_iteration <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  subnetwork <span class="op">=</span> <span class="fu">pkoi</span><span class="fu">::</span><span class="va">pkoi_net</span>,</span>
<span>  include_subnetwork <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The output is a <code>pKOIList</code> S4 object with the following slots:</p>
<ul>
<li>
<code>proteomics_data</code>: your input data with UniProt IDs, logFC, and p-values.</li>
<li>
<code>network_summary_statistics</code>: a list of data frames annotated by node type (e.g., Disease, Anatomy, GO terms).</li>
<li>
<code>subnetwork</code> <em>(optional)</em>: the full igraph object if <code>include_subnetwork = TRUE</code>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="input-requirements">Input Requirements<a class="anchor" aria-label="anchor" href="#input-requirements"></a>
</h2>
<p>Your input <code>proteomics_data</code> should be a <code>data.frame</code> with the following columns:</p>
<ul>
<li>
<code>uniprot_id</code>: character vector of UniProt IDs</li>
<li>
<code>logfc</code>: numeric log fold-change values</li>
<li>
<code>p_value</code>: numeric significance values</li>
</ul>
<p>Example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">pkoi</span><span class="fu">::</span><span class="va">example_data1</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr>
<th align="left">uniprot_id</th>
<th align="right">logfc</th>
<th align="right">p_value</th>
</tr></thead>
<tbody>
<tr>
<td align="left">Q8WU39</td>
<td align="right">2.2675323</td>
<td align="right">0.0000350</td>
</tr>
<tr>
<td align="left">P09326</td>
<td align="right">1.0652402</td>
<td align="right">0.0000757</td>
</tr>
<tr>
<td align="left">P01624</td>
<td align="right">1.3610007</td>
<td align="right">0.0009597</td>
</tr>
<tr>
<td align="left">P06312</td>
<td align="right">1.4822463</td>
<td align="right">0.0010210</td>
</tr>
<tr>
<td align="left">A0A0A0MRZ8</td>
<td align="right">1.6225022</td>
<td align="right">0.0013218</td>
</tr>
<tr>
<td align="left">P49863</td>
<td align="right">1.0998201</td>
<td align="right">0.0023031</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="output-format">Output Format<a class="anchor" aria-label="anchor" href="#output-format"></a>
</h2>
<p>The output object includes annotated tables for various biological node types, such as:</p>
<ul>
<li>Anatomy</li>
<li>Disease</li>
<li>Biological Process</li>
<li>Molecular Function</li>
<li>Cell Type</li>
<li>Compound</li>
<li>Clinical Lab</li>
<li>Pathway</li>
<li>Protein Domain / Family</li>
</ul>
<p>Each table contains:</p>
<table class="table">
<thead><tr>
<th>Column</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr>
<td><code>identifier</code></td>
<td>Node identifier (e.g., UBERON, GO, DOID)</td>
</tr>
<tr>
<td><code>pagerank</code></td>
<td>Personalized PageRank value</td>
</tr>
<tr>
<td><code>simulation_mean</code></td>
<td>Null distribution mean for PageRank</td>
</tr>
<tr>
<td><code>simulation_std</code></td>
<td>Null distribution std dev</td>
</tr>
<tr>
<td><code>beta</code></td>
<td>Z-score of observed vs null PageRank</td>
</tr>
<tr>
<td><code>p_value</code></td>
<td>Empirical p-value</td>
</tr>
<tr>
<td><code>fdr</code></td>
<td>FDR-corrected p-value</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h2>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr>
<th>Argument</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr>
<td><code>pvalue_threshold</code></td>
<td>Minimum p-value threshold for proteins to include (default: 0.01)</td>
</tr>
<tr>
<td><code>logfc_threshold</code></td>
<td>Minimum absolute logFC threshold (default: 0)</td>
</tr>
<tr>
<td><code>topology_by</code></td>
<td>Topology attribute for null matching: <code>degree</code>, <code>coreness</code>, <code>closeness</code>, etc.</td>
</tr>
<tr>
<td><code>topology_similarity</code></td>
<td>Tolerance when matching null proteins (default: 0.9)</td>
</tr>
<tr>
<td><code>n_permutation</code></td>
<td>Number of permutations for null simulation (default: 10)</td>
</tr>
<tr>
<td><code>damping_factor</code></td>
<td>Damping factor for PageRank (default: 0.85)</td>
</tr>
<tr>
<td><code>maximum_iteration</code></td>
<td>Max iterations for PageRank (default: 500)</td>
</tr>
<tr>
<td><code>include_subnetwork</code></td>
<td>Whether to include the subnetwork in the output (default: FALSE)</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>If you use <code>pKOI</code> in your research, please cite:</p>
<blockquote>
<p>Wanjun Gu. <em>pKOI: Proteomic Knowledge-Graph Omics Integration</em>, UCSF, 2025. DOI: <em>Coming soon</em></p>
</blockquote>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>This package is distributed under the MIT license. See <code>LICENSE</code> file for details.</p>
</div>
<div class="section level2">
<h2 id="contact">Contact<a class="anchor" aria-label="anchor" href="#contact"></a>
</h2>
<p>Created and maintained by <a href="mailto:wanjun.gu@ucsf.edu">Wanjun Gu</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Broccolito/pkoi" class="external-link">GitHub</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing pkoi</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Wanjun Gu <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-7342-7000" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Wanjun Gu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
